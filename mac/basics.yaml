defaults:
  exec:
    echo: true
  brew:
    force_casks: true
  link:
    force: true
    relink: true

steps:
  - link:
      - ~/Library/LaunchAgents/sh.brew.update.plist: mac/sh.brew.update.plist
      - ~/Library/LaunchAgents/sh.brew.upgrade.plist: mac/sh.brew.upgrade.plist
  - exec:
      - launchctl load /Users/$USER/Library/LaunchAgents/sh.brew.update.plist
      - launchctl load /Users/$USER/Library/LaunchAgents/sh.brew.upgrade.plist
      - install_workflows.sh
  - brew:
      tap:
        - homebrew/cask
        - miguelandres/homebrew-tap
        - homebrew/cask-fonts
        - spotify/public
      formula:
        # Ruby stuff first, it's messy.
        - ruby
        # Other stuff
        - alda
        - dezoomify-rs
        - dockutil
        - exiftool
        - fzf
        - graphviz
        - hub
        - jupyterlab
        - markdownlint-cli
        - mas
        - nailgun
        - nodejs
        - openssl
        # Eww, this is because of php in alfred workflows
        - php
        - pre-commit
        - pylint
        - python3
        - ruby
        - shellcheck
        - shfmt
        - rustup
        - sbt
        - scala
        - scio
        - vim
        - yapf
        - zsh
        - zsh-autosuggestions
      cask:
        - discord
        - github
        - jupyter-notebook-ql
        - jupyter-notebook-viewer
        - netnewswire
        - signal
        - spotify
        - steam
        - visual-studio-code
        - vlc
  - brew:
      # This is a separate brew directive so it can be skipped in CI.
      # `mas` actions should never be run in CI since they depend on a
      # Mac App Store login.
      skip_in_ci: true
      mas:
        Magnet: 441258766
        Dashlane: 517914548
        Hush: 1544743900
        Theine: 955848755
        Things: 904280696
        Tooth Fairy: 1191449274
